# 前端报错监控
只要函数内部抛出错误，就会结束这个函数的调用并且出栈
## 前端报错收集方式
### JS错误收集
#### GlobalEventHandlers.onerror
[MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onerror)

##### 1. window.onerror
当 JS 发生错误的时，通过 window.onerror 收集错误信息，存 error.stack 。
```
window.onerror = function(message, source, lineno, colno, error) { ... }

window.addEventListener('error', function(event) { ... })
```

``window.onerror``: 含有详细的 error 堆栈信息，存在 error.stack 中。选择使用 window.onerror 的方式对 **js运行时错误** 进行捕获。

``window.addEventListener('error')``: 
**跨域资源发生错误需要进行监听时**：
 - 浏览器会因跨域限制只返回一个 ``Script error``
 - 我们需要在跨域的文件上添加 ``CORS`` + 引用该文件的 ``<script>.crossorigin`` 来解决。
##### 2. element.onerror
当资源加载失败时，加载资源的元素会触发一个 Event 接口的 error 事件。

**element.onerror 可单独处理错误后续的处理函数, 一般统一由外层监听进行上报。**
```
<img src="imgSrc" onerror="Fn" />

funciton Fn(event) {
 // 重置默认图
 const element = event.srcElement;
 element.src = 'new src'
 element.onerror = null // 关闭 onerror 避免重复报错
}
```

**资源加载失败的 error 事件不会向上冒泡到 window，但能被 window.addEventListener 在捕获阶段捕获。**

##### 收集使用
使用 ``window.addEventListener`` 来进行收集错误信息，在因为在捕获阶段就能
所以当我们使用 ``window.addEventListener``设计监听错误时，不需要再使用 ``element.onerror``。

#### addEventListen('error', cb)
#### window。unhandleRejection
#### add

### Vue
#### Vue.config.errorHandler
## Sentry 错误收集应用
监控网页崩溃：window 对象的 load 和 beforeunload
