# å‰ç«¯æ˜æš—é£é¢œè‰²åˆ‡æ¢
## å‰è¨€
è¯¥ç« èŠ‚å¯¹``AntDesign``é¢œè‰²å¤„ç†è¿›è¡Œçš„æºç æ¢ç´¢ä¸æ€è€ƒã€‚
æ„å»ºè‰²ç³»ä¸UIç»Ÿä¸€æ€§ï¼Œå°±éœ€è¦UIç»„ä»¶å’ŒUIé¢œè‰²ä½“ç³»è¾¾åˆ°ä¸€è‡´çš„ç³»ç»Ÿ
æœ¬æ–‡åœ¨äºæ¢è®¨ä¸­å°ç³»ç»Ÿä¸­UIé¢œè‰²ç»“æ„å’Œè‡ªæ„ä»¿åˆ¶å“ï¼Œæºç å¤„ç†æ–¹å¼è¯·è‡ªè¡ŒæŸ¥è¯¢ã€‚

ğŸ‘‰ğŸ»[ é¡¹ç›®åœ°å€](https://github.com/YoRenChen/color-style-transform)

æœ¬æ–‡æ¢è®¨æ–¹å‘ï¼š
1. ``AntDesign`` é¢œè‰²å¤„ç†åˆ†æ
2. æ„å»ºé¢œè‰²ä¸æ˜æš—é£åˆ‡æ¢çš„ç³»ç»Ÿ

ã€ç›®å½•å¤§è‡´æµç¨‹ã€‘
- **AntDesign é¢œè‰²ç³»ç»Ÿåˆ†æ**
- **ä»£ç å®ç°**

## AntDesign é¢œè‰²ç³»ç»Ÿ 
_è¯¥ç« èŠ‚å¯¹AntDesigné¢œè‰²æ„æ€_ 
æºç æ¢ç©¶åŸºäºAntDesign-Vue(v1.6x)ä¸Šè¿›è¡Œã€‚ 
è¯¥ä½“ç³»å†…å±…äº  Less + HSVï¼Œå‡½æ•°å¼å¤„ç†é¢œè‰²åˆ†ç±»å’Œä½¿ç”¨HSVè¿›è¡Œæ˜æš—åº¦ç½®æ¢ã€‚æœ¬è´¨ä¸Šæ›´åˆ©äºå¤„ç†é¢œè‰²å…³ç³»ä¸Šçš„è€¦åˆã€‚

### ä¸»è‰²ç³»æ„å»º
AntDesign å®šä¹‰ä¸»è‰²ä¸º```@primary-color``` ã€‚ç”¨ HSV æ¨¡å‹çš„å€¼è¿›è¡Œé€’å‡/é€’å¢å¾—åˆ°å®Œæ•´æ¸å˜è‰²æ¿ï¼Œæ„å»ºä¸»è‰²å¯¹åº”çš„è¡ç”Ÿè‰²ã€‚ 
![image-20210319-024543](https://user-images.githubusercontent.com/30005394/119697383-b82e4c80-be82-11eb-97ff-38451db63b5b.png)
è¡ç”Ÿè‰²ä¸»è¦æ ¹æ®ä»¥i=6çš„ä¸»è‰²è¿›è¡Œæ¢ç®—å‡º10ä¸ª: 
```
# ant-design-vue/components/style/color/colorPalette.less
# å‡½æ•° colorPalette

# ant-design-vue/components/style/color/default.less
@color-5: color(~`colorPalette('@{color-6}', 5, '@{theme}')`);
```
æ ¹æ®é¢œè‰²å€¼ã€è‰²å·ä¸ä¸»è‰²è‰²å·(6)å·®çš„ç»å¯¹å€¼ã€å‡æ·¡/åŠ æ·±è¿™ä¸‰ä¸ªå‚æ•°è·å–æ¸å˜åçš„è‰²å€¼ï¼Œå…¶ä¸­ HSV çš„ä¸‰ä¸ªå€¼åˆ†åˆ«ç»è¿‡äº†æ¸å˜è°ƒæ•´ï¼š
```
// è·å–è‰²ç›¸æ¸å˜
# ant-design-vue/components/style/color/colorPalette.less
# å‡½æ•° getHue

var hueStep=2;
if (hsv.h >=60 && hsv.h <=240) {
   hue=isLight ? hsv.h - hueStep * i : hsv.h + hueStep * i;
}else {
   hue=isLight ? hsv.h + hueStep * i : hsv.h - hueStep * i;
}
```
æ³›è‰²çš„åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼šå…³é”®è¡ŒåŠ¨ç‚¹ï¼Œæ“ä½œçŠ¶æ€ã€é‡è¦ä¿¡æ¯é«˜äº®ï¼Œå›¾å½¢åŒ–ç­‰åœºæ™¯ã€‚
![image-20210319-024644](https://user-images.githubusercontent.com/30005394/119697585-ead84500-be82-11eb-9de1-a32e55502e0f.png)
###  æš—é»‘é£æ ¼
> åœ¨3.0ç‰ˆæœ¬ä¸­ï¼Œantd-vueä½¿ç”¨æš—é»‘é£æ ¼LESSæ–‡ä»¶è¦†ç›–default.lessæ ·å¼å®ç°ã€‚
> åœ¨antd4.0ä¸­å¯¹æš—é»‘é¢œè‰²é…å¥—è‡ªå·±çš„è§„åˆ™ï¼Œè°ƒèŠ‚è‰²å€¼å’ŒHSVä¸­çš„Vç™¾åˆ†æ¯”ã€‚

![image-20210319-024849](https://user-images.githubusercontent.com/30005394/119697655-03485f80-be83-11eb-8bde-1146d964adb0.png)
```
# ant-design-vue/components/style/themes/dark.less

@component-background: #141414;
@primary-6: @primary-color;
@primary-1: mix(color(~`colorPalette('@{primary-color}', 8) `), @component-background, 15%);
```
å‚è€ƒï¼š
1. `ant-d-vue: components/style/themes/dark.less`
2. [https://zhuanlan.zhihu.com/p/112470365](https://zhuanlan.zhihu.com/p/112470365)
3. [Ant Design è‰²æ¿ç”Ÿæˆç®—æ³•æ¼”è¿›ä¹‹è·¯](https://zhuanlan.zhihu.com/p/32422584)

## æ„å»ºé¢œè‰²è½¬æ¢
[ã€ é¡¹ç›®åœ°å€ ã€‘](https://github.com/YoRenChen/color-style-transform)

### æ„å»ºæ­¥éª¤:
1. æ³›è‰²ä¸æš—é»‘é£æ³›è‰²å®šä¹‰
2. æ„å»ºæ€è·¯åˆ†æ
3. Lessæ–‡ä»¶ä¸ç»„ä»¶çš„æ„å»º

#### æ³›è‰²ä¸æš—é»‘é£æ³›è‰²å®šä¹‰
_æœ¬æ¬¡æ„å»ºå‚è€ƒå¹¶åŸºäº Ant Design ä½¿ç”¨çš„å®šä¹‰å˜é‡ä¸æ³›è‰²æ–¹æ¡ˆã€‚_
```
// å˜é‡å®šä¹‰
# ant-design-vue/components/style/themes/default.less
# ant-design-vue/components/style/themes/dark.less

// æ³›è‰²å¤„ç†
# ant-design-vue/components/style/color/colorPalette.less

// é¢œè‰²æ–¹æ³•
# ant-design-vue/components/style/color/colorPalette/tinyColor.less
```
_æ³¨æ„ï¼šå› ä¸ºä¸Šé¢ä»£ç åœ¨Lessä¸­å®šä¹‰å‡½æ•°ï¼Œæ•…Lessé…ç½®ä¸­éœ€è¦åŠ å…¥javascriptEnabledï¼štrueæ¥å¤„ç†å‡½æ•°_
#### æ„å»ºæ€è·¯
1. åœ¨ant-design-vue Proç½‘ç«™ä¸Šè¿›è¡Œçš„é¢œè‰²åˆ‡æ¢çš„å‘ç°ï¼Œå½“æ„å»ºæ–°çš„é¢œè‰²æ—¶ä¼šæ›¿æ¢Styleæ ‡ç­¾
2. ä½¿ç”¨Lesså˜é‡ï¼Œé€šè¿‡å˜é‡æŠŠç»„ä»¶é¢œè‰²å…³è”èµ·æ¥
3. é€šè¿‡Lessçš„modifyVarså±æ€§å¯ä»¥ä¿®æ”¹åˆ°Lessçš„å˜é‡
4. Lessæ–‡ä»¶æœ€ç»ˆåˆå¹¶æˆä¸ºåŒºåˆ†æ˜(default)å’Œæš—(dark)é£æ ¼çš„æ ·å¼æ–‡ä»¶

ã€å‘ç‚¹ã€‘
1. ä¸ä½¿ç”¨cssè‡ªå®šä¹‰æ§åˆ¶å˜é‡ï¼Œå› ä¸ºåœ¨ç³»ç»Ÿå¯¹æ³›è‰²æ ¡å¯¹æ—¶ä½¿ç”¨Lessçš„Coloræ–¹æ³•ï¼Œæ— æ³•æ”¯æŒå¤æ‚è¡¨è¾¾å¼ï¼šmix(var(--primary-color), #fff, 10%)ã€‚
2. ç”±äºè¿è¡Œæ—¶less-loaderä¼šå…ˆå¯¹lessè½¬æ¢ä¸ºcss/wxssï¼Œæ­¤æ—¶æˆä¸ºæ ‡å‡†CSSæ ·è‰²æ–‡ä»¶ï¼Œå˜é‡è¢«å¼•ç”¨æˆä¸ºå®é™…æ•°å€¼ï¼Œä¸å¯ä»¥é€šè¿‡Lessçš„modifyVarså±æ€§è¿›è¡Œä¿®æ”¹ã€‚
#### Lessæ–‡ä»¶ä¸ç»„ä»¶çš„æ„å»º
##### styles æ–‡ä»¶
```
â”œâ”€â”€ styles
â”‚   â”œâ”€â”€ color (é¢œè‰²å¤„ç†)
â”‚   â”‚   â”œâ”€â”€ colorPalette.less
â”‚   â”‚   â””â”€â”€ tinyColor.less
â”‚   â”œâ”€â”€ component (ç»„ä»¶å®šä¹‰)
â”‚   â”‚   â”œâ”€â”€ button.less
â”‚   â”‚   â”œâ”€â”€ layout.less
â”‚   â”‚   â””â”€â”€ menu.less
â”‚   â”œâ”€â”€ dark.less (æš—ç³»)
â”‚   â””â”€â”€ default.less (æ˜ç³»)
```
##### ç»„ä»¶åŒºåˆ†
åœ¨å®šä¹‰ä¸€ä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åŒºåˆ†å¼€é¢œè‰²ä¸å…¶ä»–å±æ€§ã€‚ä¾‹å¦‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªButtonæ—¶ï¼ŒåŒºåˆ†å‡ºé¢œè‰²ç³»çš„å±æ€§ï¼Œå®šä¹‰é¢œè‰²ç»„ä»¶stylesï¼Œæœ€ç»ˆåˆå¹¶åˆ°default.lessä¸­ï¼Œè€Œæš—ç³»é¢œè‰²åˆ™æ˜¯åœ¨defaultåŸºç¡€ä¸Šé¢œè‰²è¦†ç›–ã€‚

![image-20210319-025434](https://user-images.githubusercontent.com/30005394/119699157-70102980-be84-11eb-91e1-852700c4e459.png)

```
@unit-prefix: unit;

# styles button.less
@import '../default.less';
.@{unit-prefix}-btn {
  color: @text-color;
  &-switch {
    background-color: @disabled-color;
    &-checked {
      background-color: @color-6;
    }
  }
}

# button.vue
<div class="unit-btn">
  <button
    :class="{'unit-btn-switch-checked': checked}"
    type="button"
    class="unit-btn-switch"
  />
</div>

# button.less
.unit-btn-switch {
  font-size: 14px;
  ...
}
```
##### Lessæ–‡ä»¶æ”¾ç½®ä¸å¼•ç”¨
ç”±äºless-loaderä¼šåœ¨é¡¹ç›®é‡Œè‡ªåŠ¨å¤„ç†ï¼Œé‚£æˆ‘ä»¬éœ€è¦æŠŠè¿™ç±»lessåˆå¹¶åˆ°publicæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ç›´æ¥åˆ›å»ºlinkè¿›è¡Œå¼•ç”¨ï¼Œåœ¨é¢œè‰²åˆ‡æ¢çš„æ—¶å€™åªéœ€è¦è·Ÿæ–°publicçš„lessæ–‡ä»¶å³å¯å®ç°ã€‚
##### Lesså¤„ç†
[ç”Ÿæˆlessæ–‡ä»¶å­˜æ”¾åˆ°publicé‡Œ.js](https://github.com/YoRenChen/color-style-transform/blob/master/src/color.js) (ğŸ‘ˆç‚¹å‡»æŸ¥çœ‹å®ç°ä»£ç )

1. éå†stylesé‡Œçš„default.lesså’Œdark.less,æŠŠä¸¤ä»½æ–‡ä»¶çš„å†…å®¹ä¸å¼•å…¥å†…å®¹éƒ½å¯¼å‡ºæ¥ï¼Œç»è¿‡csså‹ç¼©åˆ†åˆ«æˆä¸º2ä»½æ–‡ä»¶
2. ä½¿ç”¨fs.writeFileSyncæŠŠè¿™ä¸¤ä»½æ–‡ä»¶å†™åˆ°publicæ–‡ä»¶å¤¹ä¸­
3. æŠŠæ‰§è¡Œä¸Šé¢2æ­¥éª¤çš„jsæ”¾åˆ°webpackä¸­æ‰§è¡Œï¼Œé¢„å…ˆç”Ÿæˆæ–‡ä»¶

ã€æ³¨æ„ã€‘
æ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åœ¨htmlé‡Œå¼•å…¥lessï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨htmlé‡Œå¼•å…¥less.jsï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠlink`rel="stylesheet/less"`çš„lessæ–‡ä»¶è½¬æˆcssï¼Œæ‰èƒ½ç»™åˆ°å…ƒç´ ä½¿ç”¨ã€‚

![image-20210319-025635](https://user-images.githubusercontent.com/30005394/119699518-d6954780-be84-11eb-8dc5-8ba0ed50ce3a.png)

[é¢œè‰²å˜åŒ–æ—¶å€™çš„åˆ‡æ¢.js](https://github.com/YoRenChen/color-style-transform/blob/master/src/utils/setting.js) (ğŸ‘ˆç‚¹å‡»æŸ¥çœ‹å®ç°ä»£ç )

1. åˆå§‹åŒ–çš„æ—¶å€™åªéœ€è¦å¼•ç”¨publicçš„lessæ–‡ä»¶
2. é¢œè‰²è·Ÿæ–°ä¸æ˜æš—é£åˆ‡æ¢æ—¶ï¼Œåªéœ€è¦é€šè¿‡ä¿®æ”¹lessçš„modifyVarså³å¯åˆ·æ–°publicé‡Œçš„lesså˜é‡ã€‚æ˜æš—é£åˆ‡æ¢é™¤äº†ä¿®æ”¹å˜é‡æ—¶ä¹Ÿéœ€è¦åˆ‡æ¢é¡¹ç›®ä¸­lessçš„å¼•ç”¨linkçš„hrefç”±default.lesså˜ä¸ºdark.less

ã€åˆæ­¥æ•ˆæœã€‘
![Mar-16-2021 09-56-59](https://user-images.githubusercontent.com/30005394/119699733-0b090380-be85-11eb-8c02-b0f999abdf2c.gif)

çœ‹åˆ°æ•ˆæœçœŸè®©äººå…´å¥‹ï¼Œæ­£è®©äººæ„Ÿåˆ°å°±è¦åŠŸæˆåå°±çš„æ—¶å€™ï¼Œå‘ç°ä¸€ä¸ªé—®é¢˜ã€‚
ä½¿ç”¨lessä½œä¸ºä¸€ä¸ªæ ·è‰²åˆ‡æ¢æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡lessçš„modifyVarsè¿›è¡Œé¢œè‰²åˆ‡æ¢ã€‚ä¸è¿‡æœ‰ä¸ªè‡´å‘½ç¼ºç‚¹ï¼Œå°±æ˜¯è§£æï¼Œç½‘é¡µåˆšè¿›å…¥çš„æ—¶å€™ï¼Œç”±äºlessæ–‡ä»¶è§£æå’Œcssé‡ç»˜ä¼šå¯¼è‡´â€œå¡è‰²â€ã€‚

![Mar-18-2021 20-18-34](https://user-images.githubusercontent.com/30005394/119699808-1eb46a00-be85-11eb-86a8-a6c44db4ef44.gif)

ä¸‹å›¾ä¸ºPerfomanceæˆªå›¾ï¼š
![image-20210319-030346](https://user-images.githubusercontent.com/30005394/119699874-2ecc4980-be85-11eb-9106-f6918c903737.png)
(è¿™è¯´å¡ç‚¸äº†ä¸è¿‡åˆ†å§)
##### ä¼˜åŒ–
å¼•ç”¨lessçš„ä¼˜ç¼ºç‚¹æ˜æ˜¾ï¼Œé‚£ä¹ˆåœ¨çœ‹Proçš„å®˜ç½‘ï¼Œå‘ç°æ˜¯è·Ÿæ–°çš„æ˜¯CSSæ–‡ä»¶ã€‚
å¥½å®¶ä¼™ï¼Œä½¿ç”¨CSSèƒ½è§£å†³è§£æçš„æ­¥éª¤ã€‚
1. åœ¨Lessåˆå¹¶ä¹‹åä½¿ç”¨ Less çš„ `render` + `less-plugin-npm-import` è½¬æˆ css ï¼Œå¹¶è¾“å‡º
2. â€œé¢œè‰²å˜åŒ–æ—¶å€™çš„åˆ‡æ¢.jsâ€æŠŠlessæ”¹ä¸ºcss
... ...
_ï¼š"ä¸èƒ½ä½¿ç”¨modifyVarsåœ¨ä¸é‡æ–°ç”Ÿæˆlessçš„æƒ…å†µä¸‹è¿›è¡Œä¿®æ”¹ç¡®å®ç»•è·¯"
ï¼šâ€œæ²¡é—®é¢˜ï¼Œæˆ‘ä»¬åªè¦é‡æ–°è·å–åˆ°lesså†…å®¹æ‰“åŒ…â€
ï¼šâ€œæˆ–è€…å…ˆæŠŠlesæ˜¯æ‰“åŒ…ä¸‹æ¥å†ä½¿ç”¨modifyVarsä¿®æ”¹ä¹‹åè½¬CSSæ›¿æ¢ä¹‹å‰çš„CSSæ–‡ä»¶ä¸å°±è¡Œäº†å—ï¼Ÿâ€
æ€è·¯æŒºä¸é”™ï¼Œä¸è¿‡å°±æ˜¯æµè§ˆå™¨ç¯å¢ƒé‡Œä¸èƒ½ä½¿ç”¨fsçš„æ–‡ä»¶æ“ä½œ..._

**ç­‰ç­‰ï¼å®é™…ä¸Šåœ¨antDesignå®˜ç½‘ä¸­ï¼Œæœ€æ–°åŠ è½½çš„åªæœ‰ä¸€ä»½æ ·è‰²CSSï¼Œè€Œåœ¨åˆ‡æ¢é¢œè‰²ä¹‹åï¼Œå°±å¤šåŠ è½½äº†ä¸€ä»½æ ·å¼Lesså’Œless.jsï¼Œå®ç°äº†åˆ‡æ¢ã€‚**
_â€œï¼šé‚£ä¹ˆæˆ‘æƒ³åº”è¯¥æ˜¯ä¸€å¼€å§‹æ‰“åŒ…äº†Lessèµ„æºå’ŒåŸå§‹CSSæ–‡ä»¶ï¼Œå…ˆåŠ è½½çš„æ˜¯CSSï¼Œåé¢åˆ‡æ¢é¢œè‰²çš„æ—¶å€™å†å¡lessæ–‡ä»¶å’Œless.jsâ€_
å†è¯•ä¸€ä¸‹... ...

åŒæ—¶æ‰“åŒ…å‡ºæ˜æš—é£lessæ–‡ä»¶å’ŒåŸºç¡€çš„æ ·å¼CSSä¹‹åçš„æ•ˆæœï¼š

ã€ç½‘ç«™æ•ˆæœã€‘
![Mar-19-2021 10-14-35](https://user-images.githubusercontent.com/30005394/119700245-8b2f6900-be85-11eb-90a0-343ea9574af4.gif)

å†çœ‹ä¸€ä¸‹Perfomanceï¼š
![image-20210319-030541](https://user-images.githubusercontent.com/30005394/119700326-a4381a00-be85-11eb-9455-846c4dedcdc6.png)

è¿™æ ·ä¸€æ¥åˆæ­¥è¾¾æˆæƒ³è¦çš„æ•ˆæœ ğŸ‰ğŸ‰ğŸ‰
